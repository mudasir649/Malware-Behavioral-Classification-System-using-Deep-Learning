import pandas as pd
import numpy as np
import pickle
import joblib
from sklearn.model_selection import train_test_split

def classify():
    data = pd.read_csv("C:\\Users\\MudassirRiaz\\PycharmProjects\\Cuckoo Report Parser\Json_Reports\\Malware_dataset.csv")
    data = data.drop(['ID', 'Name', 'SHA1', 'SHA256', 'SHA512', 'MD5', 'Cat', 'Time', 'Tid','Category','Package'], axis='columns')
    X = data['Types'].values
    y = data['Api'].values
    from sklearn.preprocessing import LabelEncoder, OneHotEncoder
    labelencode_X = LabelEncoder()
    X = labelencode_X.fit_transform(X)
    y = labelencode_X.fit_transform(y)
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.22)
    import tensorflow as tf
    from tensorflow.keras import Sequential
    from tensorflow.keras.layers import Dense
    model = Sequential()
    model.add(Dense(2, input_dim=1, activation='relu'))
    model.add(Dense(2, activation='relu'))
    model.add(Dense(1, activation='sigmoid'))
    model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
    model.fit(X_train, y_train, batch_size=30, epochs=100)
    eval_model = model.evaluate(X_train, y_train)
    eval_model
    y_pred = model.predict(X_test)
    y_pred = (y_pred > 0.5)
    y_pred
    result = model.predict([X_test])
    result

